
I came up across this topic when I was doing Agile HTB box.
This guide is created with the help of an article by Ben Grewell.

Link: [here](https://www.bengrewell.com/cracking-flask-werkzeug-console-pin/)

---

# BASIC REQUIREMENTS:
1. LFI
2. Path to access debugger CLI after token creation

---

# How token is generated:
The app takes several information, creates an md5 or SHA1 hash from it, then encode the resulting digest as a 9-digit decimal number, with hyphens inserted every 3 digits.
The information it takes:
1. user name under which the application is running
2. Module name *Ex. flask.app, werkzeug.debug*
3. Application name *Ex. wsgi_app, DebuggedApplication, Flask*
4. Path to the Flask app
5. Mac address stripped of colons and in decimal format
    ```python
    print(mac_address)
    ```
6. machine id
7. cgroup

---

# Methods to find each information with LFI:
1. User name:
	1. Method 1: directly given in /proc/self/environ
	2. Method 2: find value of uid/gid from /proc/self/status, then the corresponding user from /etc/passwd
2. Mac Address: Get the device type from /proc/net/arp, then look in /sys/class/net/<device_type>/address
3. Machine id: From /etc/machine-id
4. Cgroup: From /proc/self/cgroup    <!-- concatenate machine id and cgroup-->
